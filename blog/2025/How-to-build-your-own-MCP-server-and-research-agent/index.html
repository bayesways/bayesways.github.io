<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>How to build an MCP server and research agent | Konstantinos Vamvourellis</title> <meta name="author" content="Konstantinos Vamvourellis"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://bayesways.github.io/blog/2025/How-to-build-your-own-MCP-server-and-research-agent/"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Konstantinos </span>Vamvourellis</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/talks/">talks</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">How to build an MCP server and research agent</h1> <p class="post-meta">June 8, 2025</p> <p class="post-tags"> <a href="/blog/2025"> <i class="fas fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/llm"> <i class="fas fa-hashtag fa-sm"></i> llm</a>   <a href="/blog/tag/mcp"> <i class="fas fa-hashtag fa-sm"></i> mcp</a>   </p> </header> <article class="post-content"> <p>Inspired by the Huggingface MCP <a href="https://huggingface.co/learn/mcp-course/unit1/introduction" rel="external nofollow noopener" target="_blank">course</a>, I decided to build an MCP application.</p> <p>I started by replicating an example from the course to ensure that it works. The MCP server implements a sentiment analysis function and the client is an agent that has access to the tool. Below is how I got it to run.</p> <p>Note this will run on the Inference Providers on HF. You get a $ 0.10 credits with a free account which is enough to run this agent a few times but you will soon get an error “You have exceeded your monthly included credits for Inference Providers. Subscribe to PRO to get 20x more monthly included credits.” You can purchase more in your settings <a href="https://huggingface.co/settings/billing/subscription" rel="external nofollow noopener" target="_blank">page</a>. I had to subscribe for a month to experiment with this. In a future post I plan to look at running this locally.</p> <h1 id="toy-example-of-mcp-server---client">Toy Example of MCP Server - Client</h1> <p>Set up a <a href="https://bayesways.github.io/blog/2025/How-I-set-up-my-project-repositories/">standard repo</a> and install the following packages</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td> <td class="rouge-code"><pre>pip <span class="nb">install</span> <span class="s2">"smolagents[mcp]"</span> <span class="s2">"gradio[mcp]"</span> mcp fastmcp textblob
</pre></td> </tr></tbody></table></code></pre></div></div> <p>Save a <code class="language-plaintext highlighter-rouge">.env</code> file</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td> <td class="rouge-code"><pre>HUGGINGFACE_API_TOKEN=&lt;yourHuggingFaceToken&gt;
</pre></td> </tr></tbody></table></code></pre></div></div> <p>you can get one from your <a href="https://huggingface.co/settings/tokens" rel="external nofollow noopener" target="_blank">settings</a> page.</p> <p>Save the <code class="language-plaintext highlighter-rouge">mcp_server.py</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td> <td class="rouge-code"><pre><span class="kn">import</span> <span class="n">gradio</span> <span class="k">as</span> <span class="n">gr</span>
<span class="kn">from</span> <span class="n">textblob</span> <span class="kn">import</span> <span class="n">TextBlob</span>

<span class="k">def</span> <span class="nf">sentiment_analysis</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">
    Analyze the sentiment of the given text.

    Args:
        text (str): The text to analyze

    Returns:
        dict: A dictionary containing polarity, subjectivity, and assessment
    </span><span class="sh">"""</span>
    <span class="n">blob</span> <span class="o">=</span> <span class="nc">TextBlob</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">sentiment</span> <span class="o">=</span> <span class="n">blob</span><span class="p">.</span><span class="n">sentiment</span>
    
    <span class="k">return</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">polarity</span><span class="sh">"</span><span class="p">:</span> <span class="nf">round</span><span class="p">(</span><span class="n">sentiment</span><span class="p">.</span><span class="n">polarity</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>  <span class="c1"># -1 (negative) to 1 (positive)
</span>        <span class="sh">"</span><span class="s">subjectivity</span><span class="sh">"</span><span class="p">:</span> <span class="nf">round</span><span class="p">(</span><span class="n">sentiment</span><span class="p">.</span><span class="n">subjectivity</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>  <span class="c1"># 0 (objective) to 1 (subjective)
</span>        <span class="sh">"</span><span class="s">assessment</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">positive</span><span class="sh">"</span> <span class="k">if</span> <span class="n">sentiment</span><span class="p">.</span><span class="n">polarity</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="sh">"</span><span class="s">negative</span><span class="sh">"</span> <span class="k">if</span> <span class="n">sentiment</span><span class="p">.</span><span class="n">polarity</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="sh">"</span><span class="s">neutral</span><span class="sh">"</span>
    <span class="p">}</span>

<span class="c1"># Create the Gradio interface
</span><span class="n">demo</span> <span class="o">=</span> <span class="n">gr</span><span class="p">.</span><span class="nc">Interface</span><span class="p">(</span>
    <span class="n">fn</span><span class="o">=</span><span class="n">sentiment_analysis</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="n">gr</span><span class="p">.</span><span class="nc">Textbox</span><span class="p">(</span><span class="n">placeholder</span><span class="o">=</span><span class="sh">"</span><span class="s">Enter text to analyze...</span><span class="sh">"</span><span class="p">),</span>
    <span class="n">outputs</span><span class="o">=</span><span class="n">gr</span><span class="p">.</span><span class="nc">JSON</span><span class="p">(),</span>
    <span class="n">title</span><span class="o">=</span><span class="sh">"</span><span class="s">Text Sentiment Analysis</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="sh">"</span><span class="s">Analyze the sentiment of text using TextBlob</span><span class="sh">"</span>
<span class="p">)</span>

<span class="c1"># Launch the interface and MCP server
</span><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">demo</span><span class="p">.</span><span class="nf">launch</span><span class="p">(</span><span class="n">mcp_server</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></td> </tr></tbody></table></code></pre></div></div> <s>Note that the app.py in the MCP course contains a small mistake as of today (6/11/25). The `sentiment_analysis` tool is returning a string that _looks_ like a dictionary (`"root={'polarity': 1.0, 'subjectivity': 1.0, 'assessment': 'positive'}"`) instead of returning an actual Python dictionary object.</s> <p>I opened a PR for this and it was accepted so this has now been corrected.</p> <p>Save the <code class="language-plaintext highlighter-rouge">mcp_client.py</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td> <td class="rouge-code"><pre><span class="kn">import</span> <span class="n">gradio</span> <span class="k">as</span> <span class="n">gr</span>
<span class="kn">import</span> <span class="n">os</span>

<span class="kn">from</span> <span class="n">mcp</span> <span class="kn">import</span> <span class="n">StdioServerParameters</span>
<span class="kn">from</span> <span class="n">smolagents</span> <span class="kn">import</span> <span class="n">InferenceClientModel</span><span class="p">,</span> <span class="n">CodeAgent</span><span class="p">,</span> <span class="n">ToolCollection</span><span class="p">,</span> <span class="n">MCPClient</span>


<span class="k">try</span><span class="p">:</span>
    <span class="n">mcp_client</span> <span class="o">=</span> <span class="nc">MCPClient</span><span class="p">(</span>
        <span class="p">{</span><span class="sh">"</span><span class="s">url</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">http://localhost:7860/gradio_api/mcp/sse</span><span class="sh">"</span><span class="p">}</span> <span class="c1"># This is the MCP Server we created in the previous section
</span>    <span class="p">)</span>
    <span class="n">tools</span> <span class="o">=</span> <span class="n">mcp_client</span><span class="p">.</span><span class="nf">get_tools</span><span class="p">()</span>

    <span class="n">model</span> <span class="o">=</span> <span class="nc">InferenceClientModel</span><span class="p">(</span><span class="n">token</span><span class="o">=</span><span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">"</span><span class="s">HUGGINGFACE_API_TOKEN</span><span class="sh">"</span><span class="p">))</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="nc">CodeAgent</span><span class="p">(</span><span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="o">*</span><span class="n">tools</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>

    <span class="n">demo</span> <span class="o">=</span> <span class="n">gr</span><span class="p">.</span><span class="nc">ChatInterface</span><span class="p">(</span>
        <span class="n">fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">message</span><span class="p">,</span> <span class="n">history</span><span class="p">:</span> <span class="nf">str</span><span class="p">(</span><span class="n">agent</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="n">message</span><span class="p">)),</span>
        <span class="nb">type</span><span class="o">=</span><span class="sh">"</span><span class="s">messages</span><span class="sh">"</span><span class="p">,</span>
        <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">Analyze the sentiment of the following text </span><span class="sh">'</span><span class="s">This is awesome</span><span class="sh">'"</span><span class="p">],</span>
        <span class="n">title</span><span class="o">=</span><span class="sh">"</span><span class="s">Agent with MCP Tools</span><span class="sh">"</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="sh">"</span><span class="s">This is a simple agent that uses MCP tools to answer questions.</span><span class="sh">"</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">demo</span><span class="p">.</span><span class="nf">launch</span><span class="p">()</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">mcp_client</span><span class="p">.</span><span class="nf">disconnect</span><span class="p">()</span>
</pre></td> </tr></tbody></table></code></pre></div></div> <p>To run the agent first open a terminals and start the server</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td> <td class="rouge-code"><pre><span class="nb">source </span>venv/bin/activate
python mcp_server.py
</pre></td> </tr></tbody></table></code></pre></div></div> <p>Then open an another terminal and start the client</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td> <td class="rouge-code"><pre><span class="nb">source </span>venv/bin/activate
python mcp_client.py
</pre></td> </tr></tbody></table></code></pre></div></div> <p>Open the client from a browser at http://127.0.0.1:7861/ and ask it for a sentiment, e.g. Analyze the sentiment of the following text “This is awesome”</p> <p>Then inspect the terminal running the client. It tells you how it’s trying to use the tool. Interestingly the agent made an error but corrected itself and got the right answer.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2025-06-15-How%20to%20build%20your%20own%20MCP%20server%20and%20research%20agent/Screenshot%202025-06-10%20at%2021.15.10-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2025-06-15-How%20to%20build%20your%20own%20MCP%20server%20and%20research%20agent/Screenshot%202025-06-10%20at%2021.15.10-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2025-06-15-How%20to%20build%20your%20own%20MCP%20server%20and%20research%20agent/Screenshot%202025-06-10%20at%2021.15.10-1400.webp"></source> <img src="/assets/img/2025-06-15-How%20to%20build%20your%20own%20MCP%20server%20and%20research%20agent/Screenshot%202025-06-10%20at%2021.15.10.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>Pretty cool.</p> <h1 id="how-does-it-work">How does it work?</h1> <p>Setting up the server is made easy with Gradio via the <code class="language-plaintext highlighter-rouge">mcp_server=True</code> flag on line 34 of <code class="language-plaintext highlighter-rouge">mcp_server.py</code>. When you call <code class="language-plaintext highlighter-rouge">demo.launch(mcp_server=True)</code>, Gradio does several MCP-related things for you automatically:</p> <ul> <li>Function Discovery: It scans your Gradio interface and finds the function we passed to <code class="language-plaintext highlighter-rouge">gr.Interface(fn=sentiment_analysis, ...)</code> on lines 24-25.</li> <li>Tool Registration: It automatically registers this function as an MCP tool with: <ul> <li>The function name as the tool name</li> <li>The function’s docstring as the tool description</li> <li>The function’s parameters and return type as the tool schema</li> </ul> </li> <li>MCP Server Creation: It creates an MCP server that exposes these tools via the standard MCP protocol</li> </ul> <p>Gradio makes it easy to turn a function into an MCP server if you know how to set it as a Gradio interface, which is simple. Plus you get a helpful UI in your browser to explore the MCP server (see the little option “Use via API or MCP” at the bottom of the Gradio UI and find the MCP tab).</p> <p>Now, the client connects to the MCP endpoint (lines 9-11 in <code class="language-plaintext highlighter-rouge">mcp_client.py</code> ) and retrieves all available tools (line 12). This is made easy for us by the <code class="language-plaintext highlighter-rouge">smolagents</code> library that implements the specific <code class="language-plaintext highlighter-rouge">get_tools()</code> method we use here.</p> <p>If instead of the server we wrote we wanted to connect to another MCP server we would only need to change line 10 of the <code class="language-plaintext highlighter-rouge">mcp_client.py</code>.</p> <h1 id="basic-research-agent">Basic Research Agent</h1> <p>Now it’s time to build something a little more useful. While I was reading the course I found myself needing to search for information I had read but could not remember in which specific chapter. A perfect job for an agent. So let’s see how we can build this. You can find the code <a href="https://github.com/bayesways/my-mcp-app" rel="external nofollow noopener" target="_blank">here</a>.</p> <p>Drawing inspiration by this <a href="https://github.com/willccbb/research-agent-lesson" rel="external nofollow noopener" target="_blank">repo</a> by Will Brown, I decided to implement the idea based on a simple fetching tool which takes in a url and iteratively explores the links in it to search for the answer to our question. For example if I wanted to know what packages we need to install for the Hugging Face course I can give the agent the url of the course and let it find the answer.</p> <p>The MCP server is a relatively simple function. The function does two things: extracts the text of the webpage into a clean markdown and collects all the links within the page. It provides the output in a structured format to be readable by the agent. The agent reads the output and has two options: answer our question based on the info so far or call the tool at its disposal with a new url. Doing this iteratively the agent can collect info on the websites that it has visited until it has enough context to answer.</p> <p>I asked it</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td> <td class="rouge-code"><pre>Go to https://huggingface.co/learn/mcp-course/unit1/introduction
and tell me what are the prerequisites for this course
</pre></td> </tr></tbody></table></code></pre></div></div> <p>and it answered correctly</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td> <td class="rouge-code"><pre>- Basic understanding of AI and LLM concepts
- Familiarity with software development principles and API concepts
- Experience with at least one programming language (Python or TypeScript examples will be shown)
</pre></td> </tr></tbody></table></code></pre></div></div> <p>The answer comes from a segment of <a href="https://huggingface.co/learn/mcp-course/unit0/introduction" rel="external nofollow noopener" target="_blank">unit 0</a> which is different that the link I provided in my question. So the agent must have found its way to unit 0 to give the right answer. Interestingly, when I asked it again the same question it answered with “No specific prerequisites mentioned, but basic understanding of AI and programming would be helpful.” In this case case the agent did not visit another url so it answered based on the info in unit 1 which is incorrect.</p> <p>Other usecases would be looking for some specific information at a website, or looking to find a specific item from an online store. For example I asked to</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td> <td class="rouge-code"><pre>Give me a list of 10 art studios in Red Hook NY from this website
https://newyork.craigslist.org/search/hhh?query=art%20studio%20redhook#search=2~gallery~0
</pre></td> </tr></tbody></table></code></pre></div></div> <p>it returned a decent list. The full logs are available <a href="https://raw.githubusercontent.com/bayesways/my-mcp-app/refs/heads/main/server_output_3.md" rel="external nofollow noopener" target="_blank">here</a>.</p> <h1 id="qa">Q&amp;A</h1> <h2 id="i-tried-demolaunchmcp_servertrue-but-it-doesnt-work">I tried <code class="language-plaintext highlighter-rouge">demo.launch(mcp_server=True)</code> but it doesn’t work.</h2> <p>For some reason I don’t totally understand I had to explicitly set <code class="language-plaintext highlighter-rouge">export GRADIO_MCP_SERVER=True</code> in the terminal to get it to actually set up the MCP server when I run it for the first time.</p> <h2 id="how-to-define-more-than-one-tools-per-server">How to define more than one tools per server?</h2> <p>Note that argument <code class="language-plaintext highlighter-rouge">fn</code> on line 25 of <code class="language-plaintext highlighter-rouge">mcp_server.py</code> does not support a list. You can still expose multiple tools in one server though. You create one interface per tool and then combine them before launching as shown below.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td> <td class="rouge-code"><pre><span class="n">tool_1_interface</span> <span class="o">=</span> <span class="n">gr</span><span class="p">.</span><span class="nc">Interface</span><span class="p">(</span>
    <span class="n">fn</span><span class="o">=</span><span class="n">sentiment_analysis</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="n">gr</span><span class="p">.</span><span class="nc">Textbox</span><span class="p">(</span><span class="n">placeholder</span><span class="o">=</span><span class="sh">"</span><span class="s">Enter text to analyze...</span><span class="sh">"</span><span class="p">),</span>
    <span class="n">outputs</span><span class="o">=</span><span class="n">gr</span><span class="p">.</span><span class="nc">JSON</span><span class="p">(),</span>
    <span class="n">title</span><span class="o">=</span><span class="sh">"</span><span class="s">Text Sentiment Analysis</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="sh">"</span><span class="s">Analyze the sentiment of text using TextBlob</span><span class="sh">"</span>
<span class="p">)</span>
<span class="n">tool_2_interface</span> <span class="o">=</span> <span class="n">gr</span><span class="p">.</span><span class="nc">Interface</span><span class="p">(</span>
    <span class="n">fn</span><span class="o">=</span><span class="n">text_summarizer</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="n">gr</span><span class="p">.</span><span class="nc">Textbox</span><span class="p">(</span><span class="n">placeholder</span><span class="o">=</span><span class="sh">"</span><span class="s">Enter text to summarize...</span><span class="sh">"</span><span class="p">),</span>
    <span class="n">outputs</span><span class="o">=</span><span class="n">gr</span><span class="p">.</span><span class="nc">JSON</span><span class="p">(),</span>
    <span class="n">title</span><span class="o">=</span><span class="sh">"</span><span class="s">Text Summary Generator</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="sh">"</span><span class="s">Summarize a text</span><span class="sh">"</span>
<span class="p">)</span>

<span class="c1"># Combine all interfaces into a tabbed interface
</span><span class="n">demo</span> <span class="o">=</span> <span class="n">gr</span><span class="p">.</span><span class="nc">TabbedInterface</span><span class="p">(</span>
    <span class="p">[</span><span class="n">tool_1_interface</span><span class="p">,</span> <span class="n">tool_2_interface</span><span class="p">],</span>
    <span class="p">[</span><span class="sh">"</span><span class="s">Sentiment Analysis</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Text Summarizer</span><span class="sh">"</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Launch with MCP server enabled
</span><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">demo</span><span class="p">.</span><span class="nf">launch</span><span class="p">(</span><span class="n">mcp_server</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></td> </tr></tbody></table></code></pre></div></div> <h2 id="what-does-get_tools-actually-do">What does <code class="language-plaintext highlighter-rouge">get_tools()</code> actually do?</h2> <p>When we call <code class="language-plaintext highlighter-rouge">get_tools()</code>, here’s what happens behind the scenes:</p> <ul> <li>Client Request: The MCP client sends a <code class="language-plaintext highlighter-rouge">tools/list</code> message to the server</li> <li>Server Response: The server responds with a list of available tools in this format: <div class="language-json highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td> <td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"jsonrpc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2.0"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"result"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
 </span><span class="nl">"tools"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
   </span><span class="p">{</span><span class="w">
     </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sentiment_analysis"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Analyze the sentiment of the given text"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"inputSchema"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
       </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w"> </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The text to analyze"</span><span class="p">}</span><span class="w">
       </span><span class="p">},</span><span class="w">
       </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"text"</span><span class="p">]</span><span class="w">
     </span><span class="p">}</span><span class="w">
   </span><span class="p">}</span><span class="w">
 </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td> </tr></tbody></table></code></pre></div> </div> </li> <li>Client Processing: The <code class="language-plaintext highlighter-rouge">MCPClient.get_tools()</code> method parses this JSON response and converts each tool definition into tool objects that your agent can use.</li> </ul> <p>The MCPClient class (from <code class="language-plaintext highlighter-rouge">smolagents</code>) implements the MCP client specification, which includes:</p> <ul> <li>Connection management: Connecting to MCP servers via different transports (HTTP SSE, stdio, etc.)</li> <li>Protocol handling: Sending/receiving MCP messages in the correct JSON-RPC format</li> <li>Tool discovery: The <code class="language-plaintext highlighter-rouge">get_tools()</code> method that sends <code class="language-plaintext highlighter-rouge">tools/list</code> requests</li> <li>Tool execution: Methods to call tools via <code class="language-plaintext highlighter-rouge">tools/call</code> requests</li> </ul> <p>and these should work with any MCP server, not just the Gradio server we wrote. That’s the point of MCP, to provide a standardized way to connect AI models to external tools and data sources. Which means:</p> <ul> <li>Standardization: Any MCP client can work with any MCP server</li> <li>Discoverability: Clients can automatically discover what tools are available</li> <li>Flexibility: Tools can be added/removed dynamically</li> <li>Security: The protocol includes mechanisms for safe tool execution</li> </ul> <h2 id="whats-the-significance-of-sse">What’s the significance of <code class="language-plaintext highlighter-rouge">sse</code>?</h2> <p>SSE stands for Server-Sent Events - it’s the transport protocol that our MCP client is using to communicate with the Gradio MCP server in this example.</p> <p>More generally MCP specifies how messages are transported between Clients and Servers. Two primary transport mechanisms are supported:</p> <ul> <li> <strong>stdio (Standard Input/Output)</strong> used for local communication, where the Client and Server run on the same machine</li> <li> <strong>HTTP + SSE (Server-Sent Events) / Streamable HTTP</strong> used for remote communication, where the Client and Server might be on different machines.</li> </ul> <p>There are more protocols supported but exploring them further is a topic for another post. The MCP course on Hugging Face contains more info on this.</p> <p>SSE/Streamable HTTP is the standard choice for most AI/ML applications because:</p> <ul> <li>Long-running operations: AI models can take time, SSE allows progress updates</li> <li>Streaming responses: Perfect for streaming text generation or real-time analysis</li> <li>Resource monitoring: Server can notify clients when resources change</li> <li>Connection persistence: Maintains connection for multiple interactions</li> </ul> <p>One last thing, if you run the code you will get a warning</p> <p><em>“specifying the ‘transport’ key is deprecated. For now, it defaults to the legacy ‘sse’ (HTTP+SSE) transport, but this default will change to ‘streamable-http’ in version 1.20. Please add the ‘transport’ key explicitly.”</em></p> <p>The streamable-http transport will become the default in version 1.20 of the <code class="language-plaintext highlighter-rouge">mcp</code> library (as of today we are on 1.9) so to avoid the warning use</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td> <td class="rouge-code"><pre><span class="n">mcp_client</span> <span class="o">=</span> <span class="nc">MCPClient</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="sh">"</span><span class="s">url</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">http://localhost:7860/gradio_api/mcp/sse</span><span class="sh">"</span><span class="p">,</span> 
        <span class="sh">"</span><span class="s">transport</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">sse</span><span class="sh">"</span> <span class="c1"># "streamable-http" is also fine
</span>    <span class="p">}</span>
<span class="p">)</span>
</pre></td> </tr></tbody></table></code></pre></div></div> <h2 id="references">References</h2> <ul> <li><a href="https://huggingface.co/learn/mcp-course/unit0/introduction" rel="external nofollow noopener" target="_blank">Hugging Face MCP Course</a></li> <li><a href="https://huggingface.co/blog/gradio-mcp" rel="external nofollow noopener" target="_blank">How to Build an MCP Server in 5 Lines of Python</a></li> <li>Will Brown’s research agent <a href="https://github.com/willccbb/research-agent-lesson" rel="external nofollow noopener" target="_blank">repo</a> </li> </ul> </article><div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"bayesways/bayesways.github.io","data-repo-id":"R_kgDOJEHZog","data-category":"Announcements","data-category-id":"DIC_kwDOJEHZos4CUlC1","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Konstantinos Vamvourellis. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>